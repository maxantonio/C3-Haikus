/*! c3haikus 2015-05-07 */
!function(a){"use strict";function b(a){a=a||{},this.phrases={},this.extend(a.phrases||{}),this.currentLocale=a.locale||"en",this.allowMissing=!!a.allowMissing,this.warn=a.warn||i}function c(a){var b,c,d,e={};for(b in a)if(a.hasOwnProperty(b)){c=a[b];for(d in c)e[c[d]]=b}return e}function d(a){var b=/^\s+|\s+$/g;return a.replace(b,"")}function e(a,b,c){var e,f,h;return null!=c&&a?(f=a.split(k),h=f[g(b,c)]||f[0],e=d(h)):e=a,e}function f(a){var b=c(m);return b[a]||b.en}function g(a,b){return l[f(a)](b)}function h(a,b){for(var c in b)"_"!==c&&b.hasOwnProperty(c)&&(a=a.replace(new RegExp("%\\{"+c+"\\}","g"),b[c]));return a}function i(b){a.console&&a.console.warn&&a.console.warn("WARNING: "+b)}function j(a){var b={};for(var c in a)b[c]=a[c];return b}b.VERSION="0.4.2",b.prototype.locale=function(a){return a&&(this.currentLocale=a),this.currentLocale},b.prototype.extend=function(a,b){var c;for(var d in a)a.hasOwnProperty(d)&&(c=a[d],b&&(d=b+"."+d),"object"==typeof c?this.extend(c,d):this.phrases[d]=c)},b.prototype.clear=function(){this.phrases={}},b.prototype.replace=function(a){this.clear(),this.extend(a)},b.prototype.t=function(a,b){var c,d;return b=null==b?{}:b,"number"==typeof b&&(b={smart_count:b}),"string"==typeof this.phrases[a]?c=this.phrases[a]:"string"==typeof b._?c=b._:this.allowMissing?c=a:(this.warn('Missing translation for key: "'+a+'"'),d=a),"string"==typeof c&&(b=j(b),d=e(c,this.currentLocale,b.smart_count),d=h(d,b)),d};var k="||||",l={chinese:function(a){return 0},german:function(a){return 1!==a?1:0},french:function(a){return a>1?1:0},russian:function(a){return a%10===1&&a%100!==11?0:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?1:2},czech:function(a){return 1===a?0:a>=2&&4>=a?1:2},polish:function(a){return 1===a?0:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?1:2},icelandic:function(a){return a%10!==1||a%100===11?1:0}},m={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};"undefined"!=typeof module&&module.exports?module.exports=b:a.Polyglot=b}(this);var i18n=new Polyglot;i18n.locale(locale),i18n.extend({from:"From",to:"To",select:"Select"}),"es"==i18n.locale()&&i18n.extend({from:"Desde",to:"Hasta",select:"Selecione"});var StockTools=function(a,b){"use strict";function c(){function c(){var a=d3.select(this).attr("data-value"),b=d3.select(this).attr("data-tipo"),c=datos.columns[0].length-1,d=parseDate(datos.columns[0][c]),e=new Date(d.getTime());parseDate(datos.columns[0][1]);switch(b){case"dia":e.setDate(d.getDate()-a);break;case"mes":e.setMonth(d.getMonth()-a);break;case"anno":e.setYear(d.getFullYear()-a);break;case"hasta_la_fecha":e=new Date(d.getFullYear(),0,1)}if(!h(e,d))throw new Error("No hay datos para este intervalo");f(e,d),document.getElementById("inicio").value=formatDate(e),document.getElementById("fin").value=formatDate(d)}function f(a,b){chart.axis.min({x:formatDate(a)}),chart.axis.max({x:formatDate(b)})}function g(){var a=parseDate(document.getElementById("inicio").value),b=parseDate(document.getElementById("fin").value);f(a,b)}function h(a,b){var c=datos.columns[0].length-1,d=parseDate(datos.columns[0][1]),e=parseDate(datos.columns[0][c]);return b||(b=e),a>=d&&e>=b}function i(a){return datos.columns[0].indexOf(a)}function j(a,b,c,d){var e=[a],f=i(c),g=i(d),h=+datos.columns[b][f];return datos.columns[b].forEach(function(a,b){if(b>0)if(b>=f&&g>=b){var c=+a,d=c/h-1;d=+d.toFixed(2),e.push(d)}else e.push(0)}),e}function k(){""!=d&&(console.info("Quitar: "+d),chart.unload(d));var a=this.options[this.selectedIndex].value;console.info("Seleccionado: "+a);var b=parseDate(document.getElementById("inicio").value),c=parseDate(document.getElementById("fin").value),e=[];if(!h(b,c))throw new Error("Intervalo incorrecto");if(0!=this.selectedIndex){d=a;var f=j(datos.columns[1][0],1,document.getElementById("inicio").value,document.getElementById("fin").value),g=j(a,this.selectedIndex+1,document.getElementById("inicio").value,document.getElementById("fin").value);e.push(f),e.push(g),chart.load({columns:e})}else d=""}var l=d3.select(a).append("div").attr("class","c3-header"),m=l.append("div").attr("class","c3-periodos").style("float","left"),n=l.append("div").attr("class","c3-intervalos").style("float","left");n.append("span").text(i18n.t("from")),n.append("input").attr("type","text").attr("name","inicio").attr("id","inicio"),n.append("span").text(i18n.t("to")),n.append("input").attr("type","text").attr("name","fin").attr("id","fin");var o=l.append("div").attr("class","c3-botones").style("float","left");o.append("button").attr("id","update").attr("type","button").text("Actualizar").on("click",g),datos.columns.forEach(function(a,b){b>0&&e.push(datos.columns[b][0])}),e[0]=i18n.t("select");var p=o.append("select").attr("class","c3_cmp");p.selectAll("opciones").data(e).enter().append("option").attr("class","opciones").attr("data-id",function(a){return a}).attr("value",function(a){return a}).text(function(a){return a}),p.on("change",k),l.append("div").attr("class","c3-clear-header").style("clear","both"),m.selectAll("botones").data(b).enter().append("button").attr("type","button").attr("class",function(a,b){return"button"+b}).attr("data-value",function(a){return a.cantidad}).attr("data-tipo",function(a){return a.tipo}).text(function(a){return a.texto}).on("click",c)}var d="",e=[];c()};